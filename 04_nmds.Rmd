---
title: "04_nmds"
output: word_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(vegan)
library(MASS)

head(data_species_wide3)
head(data_species_wide3_sites)

species_nmds <- data.frame(data_species_wide3_sites[, c(2:190)])
str(species_nmds)
species_nmds[, 1:189] <- sapply(species_nmds[, 1:189], as.integer)

species_nmds <- as.matrix(species_nmds)

```

## NMDS species
```{r}
vare.dis <- vegdist(species_nmds, method = "morisita")
vare.mds0 <- isoMDS(vare.dis)


stressplot(vare.mds0, vare.dis)
ordiplot(vare.mds0, type = "t")
```

```{r}
vare.mds <- metaMDS(species_nmds, trace = FALSE, distance = "chao")
vare.mds

plot(vare.mds, type = "t", display = "sites")
```


## NMDS environmental interpretation 

```{r}

```

```{r}
data(varechem)

ef <- envfit(vare.mds, varechem, permu = 999)
ef

plot(vare.mds, display = "sites")
plot(ef, p.max = 0.1)


```